{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "RLM MCP guardrails tool",
  "description": "rlm_risk_scan for security, auth, migrations, breaking changes",
  "definitions": {
    "rlm_risk_scan_request": {
      "type": "object",
      "required": ["context_id"],
      "properties": {
        "context_id": { "type": "string" },
        "plan_id": { "type": "string" },
        "categories": {
          "type": "array",
          "items": { "type": "string", "enum": ["security", "auth", "migrations", "breaking_changes", "all"] },
          "default": ["all"]
        }
      },
      "additionalProperties": false
    },
    "rlm_risk_scan_response": {
      "type": "object",
      "required": ["risks"],
      "properties": {
        "risks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["category", "severity", "message"],
            "properties": {
              "category": { "type": "string" },
              "severity": { "type": "string", "enum": ["low", "medium", "high", "critical"] },
              "message": { "type": "string" },
              "path": { "type": "string" },
              "line": { "type": "integer" },
              "snippet_id": { "type": "string" }
            }
          },
          "maxItems": 25
        }
      },
      "additionalProperties": false
    }
  }
}
